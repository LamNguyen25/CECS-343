/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package DisplayImage;

import java.awt.Color;
import java.util.LinkedList;
import javax.swing.*;


/**
 *
 * @author Hueletl
 */
public class Board extends JFrame {
    
    // Variables declaration - do not modify                     
    private JLabel map;
    private JLabel backGround; 
    
    private JLabel frame;
    private JLabel pane;
    
    private final LinkedList <Monster> monsters;
    private Monster curMonster;//current monster/player
    
    private JLabel curP;//current player label: JLabel right before roll button
    private JButton roll;//button to go to roll dice screen
    
    private JFrame rollDice;
    private JButton yesNewGame;//use to set visibility of this frame to false when a new game is started
    // End of variables declaration  
    
    public Board(LinkedList <Monster> monsters) {
        
        this.monsters = monsters;
        initComponents(); 
        this.rollDice = new RollDice(monsters, curMonster, yesNewGame);
      
    }
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {
        
        this.map = new JLabel();
        this.backGround = new JLabel();
        
        this.curP = new JLabel();
        this.roll = new JButton();
        
        this.yesNewGame = new JButton();
        yesNewGame.addActionListener(this::yesNewGameActionPerformed);
        
        int windowW = 1200;
        int windowH = 820;
        int windowMX = windowW/2;
        
        int x = 800;
        int y = 550;
        int w = 70;
        int h = 50;
        
        //sets current player label right before roll button
        Setting.frame(this, curP, x, y, w, h, false);
        Setting.frameText(curP, "P1", 45, Color.BLACK);
        
        //sets roll button
        x += w;
        w *= 2;  
        Setting.button(this, roll, x, y, w, h, true);
        Setting.buttonText(roll, "ROLL", 45, Color.GREEN);
        roll.addActionListener(this::rollActionPerformed);

        for(int i = 0; i < this.monsters.size(); ++i){
            
            curMonster = monsters.get(i);
            curMonster.setPCurrent(curP);//adds curP to monster
            String name = curMonster.getName();
            String player = Integer.toString(curMonster.getPlayer());
            
            w = 99;
            h = 105;
            x = 1097 - (i * w);
            y = 690;
            
            //monster pLabel
            frame = new JLabel();
            Setting.frame(this, frame, x + 20, y - 40 , 60, 40, false);
            Setting.frameText(frame, "P" + player, 30, Color.YELLOW);
            curMonster.setpLabel(frame);//sets monster pLabel
            
            //monster pIcon
            frame = new JLabel();
            Setting.frame(this, frame, x, y, w, h, true);
            Setting.image(frame,  name +".jpg");
            curMonster.setpIcon(frame);//sets monster pIcon
            
//            outsideTokyo.add(frame);
            
            x = this.getX();
            w = 300;
            h = 266;
            
            //finds the location of the monsters frame
            if(i % 2 == 0){
                y = (i/2) * h;         
            }else{
                x = w;
                y = (int)Math.floor(i/2) * h;
            }
            
            // sets the JLabesl inside every monster frame
            int k = 0;
            for(int j = (4*i); j < (4*(i+1)); ++j, ++k){

                int space = 5;
                int paneX = x + space;
                int paneY;
                int paneW = 45;
                int paneH = 40;
                int fontSize = 28;
                
                //finds pane's location
                if(k%2 == 0){
                    paneY = y + ((k/2) * (226-(2*space))) + space;
                }else{
                    paneX = x + 206 + space;
                    paneY = y + ((int)Math.floor(k/2) * (226-(2*space))) + space;
                   
                }
                
                JLabel paneL = new JLabel();
                JLabel paneR = new JLabel();
                
                int newPaneX = paneX + paneW;
                
//                Monster monster = monsters.get(i);
                
                switch (k) {
                    case 0:  //top left
                        Setting.frame(this, paneL, paneX, paneY, paneW, paneH, true);
                        Setting.image( paneL, "VP.png");
                        
                        Setting.frame(this, paneR, newPaneX, paneY, paneW, paneH, false);
                        Setting.frameText(paneR, "0", fontSize, Color.BLUE);
                        curMonster.setVP(paneR);
                        break;
                    case 1:  //top right
                        Setting.frame(this, paneL, paneX, paneY, paneW, paneH, true);
                        Setting.image( paneL, "HP.png");
                        
                        Setting.frame(this, paneR, newPaneX, paneY, paneW, paneH, false);
                        Setting.frameText(paneR, "10", fontSize, Color.RED);
                        curMonster.setHP(paneR);
                        break;
                    case 2:  //bottom left
                        Setting.frame(this, paneL, paneX, paneY, paneW, paneH, true);
                        Setting.image( paneL, "EP.png");
                        
                        Setting.frame(this, paneR, newPaneX, paneY, paneW, paneH, false);
                        Setting.frameText(paneR, "0", fontSize, Color.GREEN);
                        curMonster.setEP(paneR);
                        break;
                    case 3:  //bottom right
                        
                        JButton buttonL = new JButton();
                        Setting.button(this, buttonL, paneX, paneY, paneW, paneH, true);
                        Setting.image( buttonL, "PC.png");
                        
                        Setting.frame(this, paneR, newPaneX, paneY, paneW-space, paneH, true);
                        Setting.frameText(paneR, "0", fontSize, Color.ORANGE);
                        curMonster.setPC(paneR);
                        break;
                    default:
                        break;
                }     
            }
            
            
            
            
            
            //JLabel Monster name
            frame = new JLabel();
            Setting.frame(this, frame, x, y + (h - 100), 300, 40, false);
            Setting.frameText(frame, name, 30, Color.YELLOW);
            
            
            // monster frame
            frame = new JLabel();
            Setting.frame(this, frame, x, y, w, h, true);
            Setting.image(frame,  name +".jpg");
            
           
        }
        
        curMonster = monsters.get(0);
        
        
        Setting.frame(this, map, windowMX, 0, windowMX, windowH-22, true);
        Setting.image(map, "tokyoLand.jpg");
        
        Setting.window(this, backGround, "King Of Tokyo", windowW, windowH, true);

        pack();
    }// </editor-fold>    
    
    public void rollActionPerformed(java.awt.event.ActionEvent evt){
        
        rollDice.setVisible(true);
       
        
    }
    
    public void moveInToTokyo(Monster monster){
        int x = 870;
        int y = 60;
        monster.getpLabel().setLocation(x, y);
        monster.getpIcon().setLocation(x-20, y+40); 
        monster.setInsideTokyo(true);
        String moves = monster.getpLabel().getText() + ": " +monster.getName() + "\n";
                   moves +=  "moves into Tokyo\n";
        JOptionPane.showMessageDialog( null, moves );
        
        int vp = Integer.parseInt(monster.getVP().getText()) + 1;
        monster.getVP().setText(Integer.toString(vp));
    }
    
    public void yesNewGameActionPerformed(java.awt.event.ActionEvent evt){
        this.setVisible(false);
    }
}
